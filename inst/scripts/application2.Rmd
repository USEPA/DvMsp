---
title: "Application with Different Lakes Data"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

IGNORE THIS FILE
Relevant work was tranferred to the main document.

```{r}
library(tidyverse)
library(here)
library(sptotal)
library(skimr)
load(here("data", "nla.rda"))
```

Exploratory summary stats

```{r}
summary(nla_nomiss$total_hg)
```

```{r}
ggplot(data = nla_nomiss, aes(x = INDEX_LON_DD, y = INDEX_LAT_DD)) +
  geom_point(aes(colour = total_hg)) +
  scale_colour_viridis_c()
```

We see some spatial correlation (higher values in northeast, north, south, and somewhat high on the western coast. lower values in middle america, where it tends to be more rural).



```{r}

```

```{r}
```



Next, we perform design-based and model-based analyses using a GRTS sample of 200 sites. The following code obtains the GRTS sample.

```{r, results = "hide"}
set.seed(07262021)

```

We then perform a design-based analysis on the GRTS sample.



Combine all results:

```{r}

```

All 95% CI's contain the true mean for this one simulation. 

For this simulation, in terms of standard error:

Model GRTS < Design GRTS < Model IRS < Design IRS

In terms of how close the prediction is to the true mean (prediction - true_mean), from closest to furthest:

Model IRS < Design IRS < Model GRTS < Design GRTS

```{r}
## irs sample
ggplot(lakesobs, aes(x = total_hg)) +
         geom_histogram(colour  = "black", fill = "white", bins = 20)

## grts sample
ggplot(grts_df, aes(x = response)) +
         geom_histogram(colour  = "black", fill = "white", bins = 20)
```

Candidates for symmetric variable.

```{r}
## disturbance for benthic microinvertebrates
ggplot(data = nla_df, aes(x = MMI_BENT_NLA12)) +
  geom_histogram(colour = "black", fill = "white", bins = 20)

## disturbance for zooplankton
ggplot(data = nla_df, aes(x = MMI_ZOOP_NLA6)) +
  geom_histogram(colour = "black", fill = "white", bins = 20)

## lakeshore disturbance indicator
ggplot(data = nla_df, aes(x = RDis_IX)) +
  geom_histogram(colour = "black", fill = "white", bins = 20)
```

But, does it make sense to want to find an average for any of these?





